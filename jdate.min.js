function JDate(t,e,r,a,o,n,i){if("string"==typeof t){if(this._d=parseDate(digits_fa2en(t),!0),!this._d)throw"Cannot parse date string"}else if(0==arguments.length)this._d=new Date;else if(1==arguments.length)this._d=new Date(t instanceof JDate?t._d:t);else{var s=jd_to_gregorian(persian_to_jd_fixed(t,(e||0)+1,r||1));this._d=new Date(s[0],s[1]-1,s[2],a||0,o||0,n||0,i||0)}this._date=this._d,this._cached_date_ts=null,this._cached_date=[0,0,0],this._cached_utc_date_ts=null,this._cached_utc_date=[0,0,0]}JDate.prototype={_persianDate:function(){return this._cached_date_ts!=+this._d&&(this._cached_date_ts=+this._d,this._cached_date=jd_to_persian(gregorian_to_jd(this._d.getFullYear(),this._d.getMonth()+1,this._d.getDate()))),this._cached_date},_persianUTCDate:function(){return this._cached_utc_date_ts!=+this._d&&(this._cached_utc_date_ts=+this._d,this._cached_utc_date=jd_to_persian(gregorian_to_jd(this._d.getUTCFullYear(),this._d.getUTCMonth()+1,this._d.getUTCDate()))),this._cached_utc_date},_setPersianDate:function(t,e,r){var a=this._persianDate();a[t]=e,void 0!==r&&(a[2]=r);var o=jd_to_gregorian(persian_to_jd_fixed(a[0],a[1],a[2]));this._d.setFullYear(o[0]),this._d.setMonth(o[1]-1,o[2])},_setUTCPersianDate:function(t,e,r){var a=this._persianUTCDate();void 0!==r&&(a[2]=r),a[t]=e;var o=jd_to_gregorian(persian_to_jd_fixed(a[0],a[1],a[2]));this._d.setUTCFullYear(o[0]),this._d.setUTCMonth(o[1]-1,o[2])}};var jalaliMonths={1:{long:"فروردین",short:"فر"},2:{long:"اردیبهشت",short:"ار"},3:{long:"خرداد",short:"خر"},4:{long:"تیر",short:"تی‍"},5:{long:"مرداد",short:"مر"},6:{long:"شهریور",short:"شه‍"},7:{long:"مهر",short:"مه‍"},8:{long:"آبان",short:"آب‍"},9:{long:"آذر",short:"آذر"},10:{long:"دی",short:"دی"},11:{long:"بهمن",short:"به‍"},12:{long:"اسفند",short:"اس‍"}};JDate.prototype.getDate=function(){return this._persianDate()[2]},JDate.prototype.getMonth=function(){return this._persianDate()[1]-1},JDate.prototype.getFullYear=function(){return this._persianDate()[0]},JDate.prototype.getDay=function(){var t=this._persianDate(),e=jd_to_gregorian(persian_to_jd_fixed(t[0],t[1],t[2]));switch(new Date(e[0],e[1]-1,e[2]).getDay()){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;case 6:return 0}},JDate.prototype.getUTCDate=function(){return this._persianUTCDate()[2]},JDate.prototype.getUTCMonth=function(){return this._persianUTCDate()[1]-1},JDate.prototype.getUTCFullYear=function(){return this._persianUTCDate()[0]},JDate.prototype.setDate=function(t){this._setPersianDate(2,t)},JDate.prototype.setFullYear=function(t){this._setPersianDate(0,t)},JDate.prototype.setMonth=function(t,e){this._setPersianDate(1,t+1,e)},JDate.prototype.setUTCDate=function(t){this._setUTCPersianDate(2,t)},JDate.prototype.setUTCFullYear=function(t){this._setUTCPersianDate(0,t)},JDate.prototype.setUTCMonth=function(t,e){this._setUTCPersianDate(1,t+1,e)},JDate.prototype.echo=function(t){var e=this._persianDate();return t=t?(t=(t=(t=(t=t.replace("Y",e[0])).replace("m",e[1])).replace("M",jalaliMonths[e[1]].short)).replace("F",jalaliMonths[e[1]].long)).replace("d",e[2]):e[0]+"/"+ziro(e[1])+"/"+ziro(e[2])},JDate.prototype.getGregorian=function(){return this._d},JDate.prototype.toLocaleString=function(){return this.getFullYear()+"/"+pad2(this.getMonth()+1)+"/"+pad2(this.getDate())+" "+pad2(this.getHours())+":"+pad2(this.getMinutes())+":"+pad2(this.getSeconds())},JDate.prototype.parseDate=function(t,e){return parseDate(t,e)},JDate.parse=function(t){new JDate(t).getTime()},JDate.UTC=function(t,e,r,a,o,n,i){var s=jd_to_gregorian(persian_to_jd_fixed(t,e+1,r||1));return Date.UTC(s[0],s[1]-1,s[2],a||0,o||0,n||0,i||0)};var i,dateProps="getHours getMilliseconds getMinutes getSeconds getTime getUTCDay getUTCHours getTimezoneOffset getUTCMilliseconds getUTCMinutes getUTCSeconds setHours setMilliseconds setMinutes setSeconds setTime setUTCHours setUTCMilliseconds setUTCMinutes setUTCSeconds toDateString toISOString toJSON toString toLocaleDateString toLocaleTimeString toTimeString toUTCString valueOf".split(" "),createWrapper=function(t){return function(){return this._d[t].apply(this._d,arguments)}};for(i=0;i<dateProps.length;i++)JDate.prototype[dateProps[i]]=createWrapper(dateProps[i]);function mod(t,e){return t-e*Math.floor(t/e)}function leap_gregorian(t){return t%4==0&&!(t%100==0&&t%400!=0)}window.JDate=JDate;var GREGORIAN_EPOCH=1721425.5;function gregorian_to_jd(t,e,r){return GREGORIAN_EPOCH-1+365*(t-1)+Math.floor((t-1)/4)+-Math.floor((t-1)/100)+Math.floor((t-1)/400)+Math.floor((367*e-362)/12+(e<=2?0:leap_gregorian(t)?-1:-2)+r)}function jd_to_gregorian(t){var e,r,a,o,n,i,s,_,d,c,h,g;r=(e=Math.floor(t-.5)+.5)-GREGORIAN_EPOCH,a=Math.floor(r/146097),o=mod(r,146097),n=Math.floor(o/36524),i=mod(o,36524),s=Math.floor(i/1461),_=mod(i,1461),c=400*a+100*n+4*s+(d=Math.floor(_/365)),4!=n&&4!=d&&c++,h=e-gregorian_to_jd(c,1,1),g=e<gregorian_to_jd(c,3,1)?0:leap_gregorian(c)?1:2;var p=Math.floor((12*(h+g)+373)/367);return[c,p,e-gregorian_to_jd(c,p,1)+1]}var PERSIAN_EPOCH=1948320.5;function persian_to_jd(t,e,r){var a,o;return o=474+mod(a=t-(0<=t?474:473),2820),r+(e<=7?31*(e-1):30*(e-1)+6)+Math.floor((682*o-110)/2816)+365*(o-1)+1029983*Math.floor(a/2820)+(PERSIAN_EPOCH-1)}function jd_to_persian(t){var e,r,a,o,n,i,s,_,d;return a=(t=Math.floor(t)+.5)-persian_to_jd(475,1,1),o=Math.floor(a/1029983),1029982==(n=mod(a,1029983))?i=2820:(s=Math.floor(n/366),_=mod(n,366),i=Math.floor((2134*s+2816*_+2815)/1028522)+s+1),(e=i+2820*o+474)<=0&&e--,[e,r=(d=t-persian_to_jd(e,1,1)+1)<=186?Math.ceil(d/31):Math.ceil((d-6)/30),t-persian_to_jd(e,r,1)+1]}var Date=window.Date;function digits_fa2en(t){return t.replace(/[۰-۹]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-1728)})}function pad2(t){return t<10?"0"+t:t}function persian_to_jd_fixed(t,e,r){if(12<e||e<=0){var a=Math.floor((e-1)/12);t+=a,e-=12*a}return persian_to_jd(t,e,r)}function parseDate(t,e){var r=/^(\d|\d\d|\d\d\d\d)(?:([-\/])(\d{1,2})(?:\2(\d|\d\d|\d\d\d\d))?)?(([ T])(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d+))?)?(Z|([+-])(\d{2})(?::?(\d{2}))?)?)?$/.exec(t);if(r){var a=r[2],o=r[6],n=+r[1],i=+r[3]||1,s=+r[4]||1,_="/"!=a&&" "!=r[6],d=+r[7]||0,c=+r[8]||0,h=+r[9]||0,g=1e3*+("0."+(r[10]||"0")),p=r[11],l=_&&(p||!r[5]),u=("-"==r[12]?-1:1)*(60*(+r[13]||0)+(+r[14]||0));if((!p&&"T"!=o||_)&&1e3<=s!=1e3<=n){if(1e3<=s){if("-"==a)return;n=s=+r[1]}if(e){var f=jd_to_gregorian(persian_to_jd_fixed(n,i,s));n=f[0],i=f[1],s=f[2]}var D=new Date(n,i-1,s,d,c,h,g);return l&&D.setUTCMinutes(D.getUTCMinutes()-D.getTimezoneOffset()+u),D}}}function trnumToFa(t){return"number"==typeof t&&(t=t.toString()),t.replace(/0/g,"۰").replace(/1/g,"۱").replace(/2/g,"۲").replace(/3/g,"۳").replace(/4/g,"۴").replace(/5/g,"۵").replace(/6/g,"۶").replace(/7/g,"۷").replace(/8/g,"۸").replace(/9/g,"۹")}function trnumToEn(t){return t=t.replace(/[۰٠]/g,"0").replace(/[۱١]/g,"1").replace(/[۲٢]/g,"2").replace(/[۳٣]/g,"3").replace(/[۴٤]/g,"4").replace(/[۵٥]/g,"5").replace(/[۶٦]/g,"6").replace(/[۷٧]/g,"7").replace(/[۸٨]/g,"8").replace(/[۹٩]/g,"9")}function ziro(t){return t<10&&(t="0"+t),t}
